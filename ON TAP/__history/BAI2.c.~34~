#include<16f887.h>
#fuses intrc_io
#use delay(clock=8M)

//!#define LCD_ENABLE_PIN  PIN_E2                                    
//!#define LCD_RS_PIN      PIN_E0                                 
//!#define LCD_RW_PIN      PIN_E1                                  
//!#define LCD_DATA4       PIN_C4                                 
//!#define LCD_DATA5       PIN_c5                                   
//!#define LCD_DATA6       PIN_c6                                    
//!#define LCD_DATA7       PIN_c7
#define lcd_rs    pin_e0
#define lcd_rw    pin_e1
#define lcd_e     pin_e2
#define lcd_output   output_c
#include<tvkey4x4.c>
//!#include<LCD.c>
#include<tv_lcd.c>
const unsigned int8 ma7doan[]={0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90};
unsigned int8 kq=0, ttdem =1;


void demsp()
{
   kq=get_timer1();
   if(kq>20) set_timer1(1);
//!   lcd_gotoxy(1,1);
   lcd_command(0x80);
   printf(lcd_data,"SO LUONG SP: %02u ",kq);
//!   printf(lcd_putc,"SO LUONG SP: %02u ",kq);
   if(input(pin_c3) == 0)
   {
      delay_ms(20);
      if(input(pin_c3) == 0)
      {
         ttdem =! ttdem;
         if(ttdem==1) setup_timer_1(t1_external|t1_div_by_1);
         else setup_timer_1(t1_disabled);
         while(input(pin_c3)==0);
      }
   }
}
void main()
{  
   set_tris_c(0X09);
   set_tris_d(0);
   set_tris_e(0);
   set_tris_a(0x30);
   set_tris_b(0xff);
   setup_timer_1(t1_external|t1_div_by_1);
   set_timer1(0);
//!   lcd_init();
   lcd_setup();
   
   while(true)
   {
      demsp();
   }
}

