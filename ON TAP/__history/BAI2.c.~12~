#include<16f887.h>
#fuses intrc_io
#use delay(clock=8M)

#define lcd_rs pin_e0
#define lcd_rw pin_e1
#define lcd_e  pin_e2
#define output_lcd   output_a
#include<tv_lcd.c>
#include<tvkey4x4.c>
const unsigned int8 ma7doan[]={0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90};
#bit t1if = 0x0c.0
unsigned int8 bdn=0,giay=0,phut=0,gio=0;
void quetled()
{
   if(t1if == 1)
   {
      set_timer1(3036);
      bdn++;
      t1if=0;
      if(bdn == 10)
      {
         bdn=0;
         giay++;
         if(giay>59)
         {
            giay=0;
            phut++;
            if(phut>59)
            {
               phut=0;
               gio++;
               if(gio>23)
               {
                  phut=0;
                  gio=0;
               }
            }
         }
      }
   }
//!      output_c(ma7doan[n/1000%10]); output_low(pin_d4); delay_ms(1);output_high(pin_d4);
//!      output_c(ma7doan[n/100%10]); output_low(pin_d5); delay_ms(1);output_high(pin_d5);
//!      output_c(ma7doan[n/10%10]); output_low(pin_d6); delay_ms(1);output_high(pin_d6);
//!      output_c(ma7doan[n/1%10]); output_low(pin_d7); delay_ms(1);output_high(pin_d7);
}
void demsp()
{
   if(input(pin_a5) == 0)
   {
      delay_ms(20);
      if(input(pin_a5) == 0)
      {
         
         while(input(pin_a5)==0);
      }
   }
}
void main()
{  
   set_tris_c(0);
   set_tris_d(0);
   set_tris_e(0);
   set_tris_a(0x30);
   setup_timer_1(t1_internal|t1_div_by_8);
   set_timer1(3036);
   setup_timer_0(t0_ext_h_to_l|t0_div_1);
   set_timer0(0);
   output_c(0x80); output_low(pin_d3); delay_ms(1);output_high(pin_d3);
   output_c(0x80); output_low(pin_d5); delay_ms(1);output_high(pin_d5);
   while(true)
   {
      quetled();
   }
}

